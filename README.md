# Telegram –±–æ—Ç –¥–ª—è –≤—ã–¥–∞—á–∏ –±–∞–∑—ã –∏–∑ Excel

–ë–æ—Ç –Ω–∞ **aiogram 3**, –∫–æ—Ç–æ—Ä—ã–π:

- **—á–∏—Ç–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –±–∞–∑—É** –∏–∑ Excel-—Ñ–∞–π–ª–∞ `–ö–æ–ø–∏—è –í–∞—Ä—è —Å—Ä–º .xlsx` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞;
- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–≤–∞ –ª–∏—Å—Ç–∞**: `—Ç–≥ –¥–∏–∑—ã —é–∑–µ—Ä—ã` –∏ `–ª–∏—Å—Ç –Ω–æ–º–µ—Ä–∞`;
- –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∫–Ω–æ–ø–∫–∏ **¬´–ü–æ–ª—É—á–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö¬ª**:
  - –≤—ã–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é **20 —Ç–µ–ª–µ–≥—Ä–∞–º-–∞–∫–∫–∞—É–Ω—Ç–æ–≤** –∏ **20 –Ω–æ–º–µ—Ä–æ–≤**;
  - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Ç–¥–µ–ª—å–Ω—ã–º Excel-—Ñ–∞–π–ª–æ–º;
  - **–∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç** –≤—ã–¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–∑–µ –∑–∞ `user_id` –∏ `username` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
  - **–ø–æ–≤—Ç–æ—Ä–Ω–æ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –Ω–µ –≤—ã–¥–∞—é—Ç—Å—è** –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º;
  - **–ª–∏–º–∏—Ç**: –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–∞–∫–æ–π –ø–∞–∫–µ—Ç (20 –Ω–æ–º–µ—Ä–æ–≤). –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ –±–æ—Ç –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `bot.py` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –±–æ—Ç–∞.
- `requirements.txt` ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.
- `–ö–æ–ø–∏—è –í–∞—Ä—è —Å—Ä–º .xlsx` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ (–¥–æ–ª–∂–Ω–∞ –ª–µ–∂–∞—Ç—å –≤ —ç—Ç–æ–º –∂–µ –∫–∞—Ç–∞–ª–æ–≥–µ).

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- –î–æ—Å—Ç—É–ø–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã Telegram Bot API.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é):

   ```bash
   python -m venv .venv
   .venv\Scripts\activate
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

   ```bash
   pip install -r requirements.txt
   ```

3. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–ª–∂–µ–Ω –ª–µ–∂–∞—Ç—å —Ñ–∞–π–ª –±–∞–∑—ã:

   - `–ö–æ–ø–∏—è –í–∞—Ä—è —Å—Ä–º .xlsx`
   - –í –Ω—ë–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–∏—Å—Ç—ã:
     - `—Ç–≥ –¥–∏–∑—ã —é–∑–µ—Ä—ã`
     - `–ª–∏—Å—Ç –Ω–æ–º–µ—Ä–∞`

4. –°–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å —Ç–æ–∫–µ–Ω–æ–º –±–æ—Ç–∞ Telegram:

   - –í Windows PowerShell:

     ```bash
     setx BOT_TOKEN "–¢–û–ö–ï–ù_–¢–í–û–ï–ì–û_–ë–û–¢–ê"
     ```

   –∏–ª–∏ —Å–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –∏ –∑–∞–ø–∏—à–∏:

   ```env
   BOT_TOKEN=–¢–û–ö–ï–ù_–¢–í–û–ï–ì–û_–ë–û–¢–ê
   ```

## –ó–∞–ø—É—Å–∫

–ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞ –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
python bot.py
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`.
2. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É **¬´üì¶ –ü–æ–ª—É—á–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö¬ª**.
3. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏:
   - –±–æ—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `–ö–æ–ø–∏—è –í–∞—Ä—è —Å—Ä–º .xlsx`;
   - –Ω–∞ –ª–∏—Å—Ç–µ `—Ç–≥ –¥–∏–∑—ã —é–∑–µ—Ä—ã` –∏ `–ª–∏—Å—Ç –Ω–æ–º–µ—Ä–∞`:
     - –∏—â–µ—Ç –ø–µ—Ä–≤—ã–µ —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (–≥–¥–µ –µ—â—ë –Ω–µ—Ç –ø–æ–º–µ—Ç–∫–∏, —á—Ç–æ –æ–Ω–∏ –≤—ã–¥–∞–Ω—ã);
     - –±–µ—Ä—ë—Ç –¥–æ 20 —Ç–µ–ª–µ–≥—Ä–∞–º–æ–≤ –∏ –¥–æ 20 –Ω–æ–º–µ—Ä–æ–≤;
     - –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏:
       - `assigned_user_id`
       - `assigned_username`
       - `assigned_at`
       ‚Äî —Ç–µ–º —Å–∞–º—ã–º **–∂—ë—Å—Ç–∫–æ –∑–∞–∫—Ä–µ–ø–ª—è—è –∑–∞–ø–∏—Å–∏ –∑–∞ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º**;
   - —Å–æ–∑–¥–∞—ë—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π Excel-—Ñ–∞–π–ª —Å –¥–≤—É–º—è –ª–∏—Å—Ç–∞–º–∏ (20 –¢–ì –∏ 20 –Ω–æ–º–µ—Ä–æ–≤) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
4. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø–æ–ª—É—á–∞–ª —Å–≤–æ–∏ –Ω–æ–º–µ—Ä–∞ (–ø–æ –¥–∞–Ω–Ω—ã–º –≤ –ª–∏—Å—Ç–µ `–ª–∏—Å—Ç –Ω–æ–º–µ—Ä–∞`), –±–æ—Ç –ø–∏—à–µ—Ç, —á—Ç–æ –ª–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω –∏ –±–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–¥–∞—ë—Ç.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–≤–æ–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–ª–æ–Ω–æ–∫

–ö–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ:

- –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞ ‚Äî **–∑–∞–≥–æ–ª–æ–≤–∫–∏**;
- **–¥–∞–Ω–Ω—ã–µ (—é–∑–µ—Ä–Ω–µ–π–º—ã / –Ω–æ–º–µ—Ä–∞)** –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ **–ø–µ—Ä–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ** –ª–∏—Å—Ç–∞;
- —Å–ª—É–∂–µ–±–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –≤ –∫–æ–Ω—Ü–µ:
  - `assigned_user_id`
  - `assigned_username`
  - `assigned_at`

–ï—Å–ª–∏ —É —Ç–µ–±—è –¥—Ä—É–≥–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–æ–≤, –º–æ–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `bot.py` (—Ñ—É–Ω–∫—Ü–∏–∏ `_assign_records` –∏ `_count_user_numbers`).

